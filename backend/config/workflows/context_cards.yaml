# Context Cards - UI cards that reflect invisible state
# Cards guide users through the workflow by showing progress, next steps, and available actions

version: "1.0"
card_system_name: "child_development_context_cards"
description: "Dynamic UI cards that adapt to session state, phase, and progress"

# Card display rules
display_rules:
  max_cards_visible: 4  # Don't overwhelm user
  priority_ordering: true  # Show highest priority cards first
  auto_dismiss: true  # Some cards auto-dismiss after action
  animation: fade_in_out

# Card types for styling
card_types:
  progress:
    icon: "progress-bar"
    color: "blue"
    style: "informational"

  action_needed:
    icon: "alert-circle"
    color: "orange"
    style: "call-to-action"

  success:
    icon: "check-circle"
    color: "green"
    style: "celebration"

  guidance:
    icon: "lightbulb"
    color: "purple"
    style: "helpful"

  ongoing_support:
    icon: "heart"
    color: "pink"
    style: "supportive"

# Cards in the system
cards:
  # ========================================
  # SCREENING PHASE CARDS
  # ========================================

  welcome_card:
    name: "×‘×¨×•×›×” ×”×‘××”"
    name_en: "Welcome"
    card_type: guidance
    priority: 100  # Highest - show first

    # When to show this card
    display_conditions:
      phase: screening
      message_count: 0
      show_once: true

    # Card content
    content:
      title: "×©×œ×•× {parent_name}, × ×¢×™× ×œ×”×›×™×¨! ğŸ’™"
      body: |
        ×× ×™ ×›××Ÿ ×›×“×™ ×œ×¢×–×•×¨ ×œ×š ×œ×”×‘×™×Ÿ ×˜×•×‘ ×™×•×ª×¨ ××ª ×”×”×ª×¤×ª×—×•×ª ×©×œ {child_name}.

        **××™×š ×–×” ×¢×•×‘×“?**
        1. × ×“×‘×¨ ×¢×œ {child_name} - ×”×©×™×—×” ×—×•×¤×©×™×ª ×•× ×¢×™××”
        2. ××ª ×ª×¢×œ×™ 3 ×¡×¨×˜×•× ×™× ×§×¦×¨×™×
        3. ×× ×ª×— ×•××›×™×Ÿ ×¢×‘×•×¨×š ×“×•×— ××§×™×£

        **×”×›×œ ×¤×¨×˜×™ ×•×××•×‘×˜×—.** ××¤×©×¨ ×œ×”×ª×—×™×œ ××ª×™ ×©× ×•×— ×œ×š.

      footer: "×‘×•××™ × ×ª×—×™×œ - ×¡×¤×¨×™ ×œ×™ ×§×¦×ª ×¢×œ {child_name} ğŸ˜Š"

    # Available actions from this card
    available_actions:
      - continue_interview
      - view_privacy_policy

    # Behavior
    dismissible: true
    auto_dismiss_after_action: true

  interview_progress_card:
    name: "×”×ª×§×“××•×ª ×”×¨××™×•×Ÿ"
    name_en: "Interview Progress"
    card_type: progress
    priority: 90

    # When to show
    display_conditions:
      phase: screening
      completeness: "< 0.80"
      message_count: "> 2"  # After initial exchange

    # Card content (dynamic based on state)
    content:
      title: "××™×¤×” ×× ×—× ×• ×‘×ª×”×œ×™×š?"
      body_template: |
        **×”×©×œ×× ×• {completeness_percentage}% ××”×¨××™×•×Ÿ** ğŸ“Š

        {progress_description}

        **×¢×•×“ ×›××” ×“×‘×¨×™× ×©×—×©×•×‘ ×œ×™ ×œ×“×¢×ª:**
        {missing_areas}

      # Dynamic sections
      progress_description_by_range:
        "0-30":
          text: "×× ×—× ×• ×‘×”×ª×—×œ×” - ××›×™×¨×™× ×œ××˜ ×œ××˜ ××ª {child_name}."
          tone: "patient"
        "30-60":
          text: "××ª×§×“××™× ×™×¤×”! ×× ×™ ×›×‘×¨ ××ª×—×™×œ×” ×œ×”×‘×™×Ÿ ××ª {child_name}."
          tone: "encouraging"
        "60-80":
          text: "×›××¢×˜ ×¡×™×™×× ×•! ×™×© ×œ×™ ×ª××•× ×” ×“×™ ×˜×•×‘×”."
          tone: "excited"

      # What's missing (generated from schema weights)
      missing_areas_generation:
        source: extraction_schema
        show_top_n: 3
        format: "â€¢ {field_description_he}"

      footer: "××™×Ÿ ×¦×•×¨×š ×œ××”×¨ - × ×¢×©×” ××ª ×–×” ×‘×§×¦×‘ ×©× ×•×— ×œ×š ğŸ’™"

    # Available actions
    available_actions:
      - continue_interview
      - add_journal_entry
      - take_break  # Save and come back later

    # Behavior
    dismissible: false  # Always visible during interview
    updates_dynamically: true  # Re-render when completeness changes

  interview_complete_card:
    name: "×”×¨××™×•×Ÿ ×”×•×©×œ×"
    name_en: "Interview Complete"
    card_type: success
    priority: 95

    # When to show
    display_conditions:
      phase: screening
      completeness: ">= 0.80"
      video_guidelines_status: "!= ready"  # Not shown yet

    # Card content
    content:
      title: "×¡×™×™×× ×• ××ª ×”×¨××™×•×Ÿ! ğŸ‰"
      body: |
        ×ª×•×“×” ×©×—×œ×§×ª ××™×ª×™ ×›×œ ×›×š ×”×¨×‘×” ×¢×œ {child_name}.

        **×”×¦×¢×“ ×”×‘×: ×¡×¨×˜×•× ×™ ×”×ª× ×”×’×•×ª**

        ×× ×™ ××›×™× ×” ×¢×‘×•×¨×š ×”× ×—×™×•×ª ×¦×™×œ×•× ××•×ª×××•×ª ××™×©×™×ª - ××” ×›×“××™ ×œ×¦×œ× ×•××™×š.

        ×”×¡×¨×˜×•× ×™× ×™×¢×–×¨×• ×œ×™ ×œ×¨××•×ª ××ª {child_name} ×‘×¤×¢×•×œ×” ×•×œ×ª×ª ×œ×š ×ª××•× ×” ××“×•×™×§×ª ×™×•×ª×¨.

      footer: "×œ×•×—×¦×™× ×¢×œ '×”×¦×’ ×”× ×—×™×•×ª ×¦×™×œ×•×' ×›×©××ª ××•×›× ×” ğŸ“¹"

    # Available actions
    available_actions:
      - view_video_guidelines
      - continue_interview  # Can add more info
      - consultation  # Ask questions

    # Behavior
    dismissible: false
    auto_dismiss_after_action: view_video_guidelines

  video_guidelines_card:
    name: "×”× ×—×™×•×ª ×¦×™×œ×•×"
    name_en: "Video Guidelines"
    card_type: action_needed
    priority: 85

    # When to show
    display_conditions:
      phase: screening
      video_guidelines_status: ready
      uploaded_video_count: "< 3"

    # Card content
    content:
      title: "×”× ×—×™×•×ª ×”×¦×™×œ×•× ××•×›× ×•×ª! ğŸ“¹"
      body: |
        ×”×›× ×ª×™ ×¢×‘×•×¨×š ×”× ×—×™×•×ª ××•×ª×××•×ª ××™×©×™×ª ×¢×œ ×¡××š ××” ×©×¡×™×¤×¨×ª ×œ×™.

        **××” ×œ×¦×œ×:**
        {guidelines_summary}

        **×›××” ×¡×¨×˜×•× ×™×?**
        ×¦×¨×™×›×™× 3 ×¡×¨×˜×•× ×™× ×§×¦×¨×™× (2-5 ×“×§×•×ª ×›×œ ××—×“) ×‘××¦×‘×™× ×©×•× ×™×.

        {upload_progress}

      # Dynamic sections
      guidelines_summary:
        source: video_guidelines_artifact
        extract: situations_to_capture
        format: "â€¢ {situation}"
        max_items: 3

      upload_progress:
        template: "**×¢×“ ×›×” ×”×•×¢×œ×•: {uploaded_count}/3 ×¡×¨×˜×•× ×™×** {progress_emoji}"
        progress_emoji_by_count:
          0: "â¬œâ¬œâ¬œ"
          1: "âœ…â¬œâ¬œ"
          2: "âœ…âœ…â¬œ"
          3: "âœ…âœ…âœ…"

      footer_by_upload_count:
        0: "××¤×©×¨ ×œ×”×¢×œ×•×ª ××ª ×”×¡×¨×˜×•×Ÿ ×”×¨××©×•×Ÿ ğŸ¬"
        1: "×™×•×¤×™! ×‘×•××™ × ×¢×œ×” ×¢×•×“ 2 ×¡×¨×˜×•× ×™×"
        2: "×›××¢×˜ ×¡×™×™×× ×•! ×¢×•×“ ×¡×¨×˜×•×Ÿ ××—×“"

    # Available actions
    available_actions:
      - upload_video
      - view_video_guidelines  # See full guidelines
      - consultation

    # Behavior
    dismissible: false
    updates_dynamically: true
    auto_dismiss_when: "uploaded_video_count >= 3"

  video_analysis_card:
    name: "× ×™×ª×•×— ×¡×¨×˜×•× ×™×"
    name_en: "Video Analysis"
    card_type: progress
    priority: 88

    # When to show
    display_conditions:
      phase: screening
      uploaded_video_count: ">= 3"
      video_analysis_status: ["pending", "analyzing"]
      reports_status: "!= ready"

    # Card content varies by analysis state
    content_by_status:
      pending:
        title: "××•×›× ×™× ×œ× ×™×ª×•×—! ğŸ¥"
        body: |
          3 ×”×¡×¨×˜×•× ×™× ×”×•×¢×œ×• ×‘×”×¦×œ×—×”.

          **××” ×§×•×¨×” ×¢×›×©×™×•?**
          ×× ×™ ×”×•×œ×›×ª ×œ× ×ª×— ××ª ×”×¡×¨×˜×•× ×™× - ×œ×¦×¤×•×ª ×‘×”× ×‘×¢×™×•×Ÿ ×•×œ×—×¤×© ×“×¤×•×¡×™×, ×—×•×–×§×•×ª, ×•××ª×’×¨×™×.

          ×–×” ×œ×•×§×— ×›××” ×–××Ÿ (×‘×“×¨×š ×›×œ×œ 10-15 ×“×§×•×ª), ××‘×œ ×©×•×•×” ××ª ×”×”××ª× ×” ğŸ’™

        actions: [analyze_videos, consultation]

      analyzing:
        title: "×× ×ª×—×ª ××ª ×”×¡×¨×˜×•× ×™×... ğŸ”"
        body: |
          **×”×ª×”×œ×™×š ×‘×¢×™×¦×•××•!**

          ×× ×™ ×¦×•×¤×” ×‘×¡×¨×˜×•× ×™× ×©×œ {child_name} ×•××—×¤×©×ª:
          â€¢ ×“×¨×›×™ ×ª×§×©×•×¨×ª
          â€¢ ××™× ×˜×¨××§×¦×™×•×ª ×—×‘×¨×ª×™×•×ª
          â€¢ ××©×—×§ ×•×™×¦×™×¨×ª×™×•×ª
          â€¢ ×ª×’×•×‘×•×ª ×—×•×©×™×•×ª
          â€¢ ×•×™×¡×•×ª ×¨×’×©×™

          {analysis_progress}

        analysis_progress:
          show_spinner: true
          estimated_time_remaining: "{minutes} ×“×§×•×ª"

        actions: [consultation, add_journal_entry]

    # Behavior
    dismissible: false
    updates_dynamically: true
    auto_dismiss_when: "video_analysis_status == complete"

  reports_ready_card:
    name: "×”×“×•×— ××•×›×Ÿ"
    name_en: "Report Ready"
    card_type: success
    priority: 100

    # When to show
    display_conditions:
      phase: [screening, ongoing]  # Can show in both
      reports_status: ready
      user_viewed_report: false

    # Card content
    content:
      title: "×”×“×•×— ×©×œ×š ××•×›×Ÿ! ğŸ“„âœ¨"
      body: |
        **×”×¢×¨×›×” ×”×•×©×œ××”!**

        ×”×›× ×ª×™ ×¢×‘×•×¨×š ×“×•×— ××§×™×£ ×¢×œ {child_name}:
        â€¢ ×—×•×–×§×•×ª ×•×ª×›×•× ×•×ª ×™×™×—×•×“×™×•×ª
        â€¢ ×ª×¦×¤×™×•×ª ×”×ª×¤×ª×—×•×ª×™×•×ª
        â€¢ ×”××œ×¦×•×ª ××¢×©×™×•×ª
        â€¢ ×¦×¢×“×™× ×”×‘××™×

        ×”×“×•×— ×›×ª×•×‘ ×‘×©×¤×” × ×’×™×©×”, ×¢× ×“×’×© ×¢×œ ×”×—×•×–×§×•×ª ×©×œ {child_name} ×•×”××¤×©×¨×•×™×•×ª ×œ×ª××™×›×”.

      footer: "×œ×—×¦×™ ×¢×œ '×”×¦×’ ×“×•×—' ×›×©××ª ××•×›× ×” ×œ×§×¨×•× ğŸ’™"

    # Available actions
    available_actions:
      - view_report
      - download_report
      - consultation

    # Behavior
    dismissible: true
    celebration_animation: true
    auto_dismiss_after_action: view_report

  # ========================================
  # ONGOING PHASE CARDS
  # ========================================

  ongoing_welcome_card:
    name: "×©×œ×‘ ×”×œ×™×•×•×™ ×”××ª××©×š"
    name_en: "Ongoing Support Phase"
    card_type: ongoing_support
    priority: 85

    # When to show
    display_conditions:
      phase: ongoing
      phase_entry_message_shown: false  # Show once when entering phase

    # Card content
    content:
      title: "×‘×¨×•×›×” ×”×‘××” ×œ×©×œ×‘ ×”×œ×™×•×•×™! ğŸ’™"
      body: |
        **×”×¢×¨×›×” ×”×¨××©×•× ×™×ª ×”×•×©×œ××” - ××” ×¢×›×©×™×•?**

        ××¢×›×©×™×• ×× ×™ ×›××Ÿ ×‘×©×‘×™×œ×š ×œ××•×¨×š ×–××Ÿ:

        ğŸ“– **×™×•××Ÿ ×”×ª×¤×ª×—×•×ª** - ×ª×™×¢×“×™ ×ª×¦×¤×™×•×ª ×•×× ×™ ××¢×–×•×¨ ×œ×š ×œ×¢×§×•×‘ ××—×¨×™ ×”×”×ª×§×“××•×ª

        ğŸ’¬ **×©××œ×•×ª ×•×ª××™×›×”** - ×‘×›×œ ×–××Ÿ ×©×™×© ×œ×š ×©××œ×”, ×× ×™ ×›××Ÿ

        ğŸ” **×—×™×‘×•×¨ ×œ××•××—×™×** - ××¢×–×•×¨ ×œ×š ×œ××¦×•× ××ª ×”×× ×©×™× ×”××ª××™××™×

        ğŸ”„ **×”×¢×¨×›×” ××—×•×“×©×ª** - ×›×©× ×¨×¦×”, × ×•×›×œ ×œ×¢×©×•×ª ×”×¢×¨×›×” ××¢×•×“×›× ×ª

      footer: "××™×Ÿ ××˜×¨×” ×§×‘×•×¢×” - ×–×” ×ª×”×œ×™×š. ×× ×™ ×›××Ÿ ××™×ª×š ğŸŒŸ"

    # Available actions
    available_actions:
      - add_journal_entry
      - view_report
      - find_experts
      - consultation

    # Behavior
    dismissible: true
    show_once: true

  journal_card:
    name: "×™×•××Ÿ ×”×ª×¤×ª×—×•×ª"
    name_en: "Development Journal"
    card_type: guidance
    priority: 70

    # When to show - only after interview is mostly complete or in ongoing phase
    display_conditions:
      phase: [ongoing, re_assessment]  # Only in ongoing/re-assessment, NOT during screening
      journal_entry_count: "< 100"  # Don't nag forever

    # Card content varies by journal state
    content_by_state:
      empty_journal:
        title: "×”×ª×—×™×œ×™ ×™×•××Ÿ ×”×ª×¤×ª×—×•×ª ğŸ“–"
        body: |
          **×œ××” ×™×•××Ÿ?**

          ×ª×™×¢×•×“ ×¨×’×¢×™×, ×ª×¦×¤×™×•×ª, ×•×©××œ×•×ª ×¢×•×–×¨:
          â€¢ ×œ×¢×§×•×‘ ××—×¨×™ ×”×ª×¤×ª×—×•×ª ×œ××•×¨×š ×–××Ÿ
          â€¢ ×œ×–×”×•×ª ×“×¤×•×¡×™×
          â€¢ ×œ×”×›×™×Ÿ ×©××œ×•×ª ×œ××•××—×™×
          â€¢ ×œ×¨××•×ª ××ª ×”×¦××™×—×”

          ××¤×©×¨ ×œ×›×ª×•×‘ ×›×œ ×“×‘×¨ - ××™×Ÿ "× ×›×•×Ÿ" ××• "×œ× × ×›×•×Ÿ" ğŸ’™

        actions: [add_journal_entry]

      has_entries:
        title: "×™×•××Ÿ ×”×”×ª×¤×ª×—×•×ª ×©×œ×š ğŸ“–"
        body: |
          **{journal_entry_count} ×¨×©×•××•×ª ×¢×“ ×›×”**

          {recent_entry_preview}

          ×ª×™×¢×•×“ ×¨×¦×™×£ ×¢×•×–×¨ ×œ×¨××•×ª ××ª ×”×ª××•× ×” ×”×’×“×•×œ×” ×•×œ×¢×§×•×‘ ××—×¨×™ ×©×™× ×•×™×™×.

        recent_entry_preview:
          source: latest_journal_entry
          format: |
            **××—×¨×•×Ÿ:**
            ğŸ“… {entry_date}
            "{entry_content_preview}..."

        actions: [add_journal_entry, view_journal]

    # Behavior
    dismissible: true
    re_show_after_days: 7  # Gentle reminder

  follow_up_summary_ready_card:
    name: "×¡×™×›×•× ××¢×§×‘ ××•×›×Ÿ"
    name_en: "Follow-up Summary Ready"
    card_type: success
    priority: 80

    # When to show
    display_conditions:
      phase: ongoing
      has_new_follow_up_summary: true
      user_viewed_summary: false

    # Card content
    content:
      title: "×¡×™×›×•× ×”×ª×§×•×¤×” ×”××—×¨×•× ×” ğŸ“Š"
      body: |
        × ×™×ª×—×ª×™ ××ª ×¨×©×•××•×ª ×”×™×•××Ÿ ×©×œ×š ×-{days_covered} ×”×™××™× ×”××—×¨×•× ×™×.

        **×‘×¡×™×›×•×:**
        â€¢ ×ª×¦×¤×™×•×ª ××¨×›×–×™×•×ª
        â€¢ ×“×¤×•×¡×™× ×©×–×™×”×™×ª×™
        â€¢ ×”×ª×§×“××•×ª ×‘×™×—×¡ ×œ×‘×¡×™×¡
        â€¢ ×”××œ×¦×•×ª ×œ×¦×¢×“×™× ×”×‘××™×

        {summary_preview}

      summary_preview:
        source: latest_follow_up_summary
        extract: key_observations.progress_areas
        format: "âœ¨ {progress_area}"
        max_items: 2

      footer: "×›×“××™ ×œ×”×¢×™×£ ××‘×˜ ğŸ’™"

    # Available actions
    available_actions:
      - view_follow_up_summary
      - download_summary
      - consultation

    # Behavior
    dismissible: true
    auto_dismiss_after_action: view_follow_up_summary

  expert_finder_card:
    name: "××¦×™××ª ××•××—×™×"
    name_en: "Find Experts"
    card_type: guidance
    priority: 65

    # When to show
    display_conditions:
      phase: ongoing
      reports_status: ready
      expert_search_count: "< 3"  # Don't show forever

    # Card content
    content:
      title: "×¦×¨×™×›×” ×¢×–×¨×” ××§×¦×•×¢×™×ª? ğŸ‘¥"
      body: |
        **××¤×©×¨ ×œ×¢×–×•×¨ ×œ×š ×œ××¦×•× ××•××—×™×**

        ×‘×”×ª×‘×¡×¡ ×¢×œ ×”×“×•×— ×©×œ {child_name}, ××•×›×œ ×œ×”××œ×™×¥ ×¢×œ:
        â€¢ ××˜×¤×œ×™× ×‘×¢×™×¡×•×§
        â€¢ ×§×œ×™× ××™ ×ª×§×©×•×¨×ª
        â€¢ ×¤×¡×™×›×•×œ×•×’×™× ×”×ª×¤×ª×—×•×ª×™×™×
        â€¢ ×™×•×¢×¦×™× ×—×™× ×•×›×™×™×
        â€¢ {additional_specialist}

        ×”×”××œ×¦×•×ª ××•×ª×××•×ª ×œ×¦×¨×›×™× ×•×œ××™×§×•× ×©×œ×š.

      additional_specialist:
        source: professional_report
        extract: recommendations.specialist_referrals
        format: "{specialist_type}"

      footer: "×œ×•×—×¦×™× ×¢×œ '××¦× ××•××—×™×' ×œ×”×ª×—×™×œ"

    # Available actions
    available_actions:
      - find_experts
      - consultation

    # Behavior
    dismissible: true
    re_show_after_days: 30

  # ========================================
  # RE-ASSESSMENT PHASE CARDS
  # ========================================

  re_assessment_welcome_card:
    name: "×”×¢×¨×›×” ××—×•×“×©×ª"
    name_en: "Re-assessment"
    card_type: progress
    priority: 90

    # When to show
    display_conditions:
      phase: re_assessment
      phase_entry_message_shown: false

    # Card content
    content:
      title: "×‘×•××™ × ×¢×“×›×Ÿ ××ª ×”×”×‘× ×” ×©×œ× ×• ğŸ”„"
      body: |
        **×”×¢×¨×›×” ××—×•×“×©×ª ×©×œ {child_name}**

        ×–×” ×”×–××Ÿ ×œ×¨××•×ª ××™×š {child_name} ×”×ª×¤×ª×—/×” ×××– ×”×”×¢×¨×›×” ×”×¨××©×•× ×™×ª.

        **×”×ª×”×œ×™×š:**
        1. ×©×™×—×” ×××•×§×“×ª ×¢×œ ×”×©×™× ×•×™×™× ×•×”×ª×¤×ª×—×•×ª
        2. ×¡×¨×˜×•× ×™× ×—×“×©×™× (×× × ×—×•×¥)
        3. ×“×•×— ××¢×•×“×›×Ÿ ×¢× ×”×©×•×•××” ×œ×‘×¡×™×¡

        {focus_areas}

      focus_areas:
        source: re_assessment_configuration
        extract: areas_to_re_evaluate
        format: "â€¢ {area}"

      footer: "×‘×•××™ × ×ª×—×™×œ - ××” ×”×©×ª× ×” ×××– ×”×¤×¢× ×”×§×•×“××ª?"

    # Available actions
    available_actions:
      - continue_interview
      - view_journal  # Review what was documented
      - consultation

    # Behavior
    dismissible: false
    show_once: true

  re_assessment_progress_card:
    name: "×”×ª×§×“××•×ª ×”×¢×¨×›×” ××—×•×“×©×ª"
    name_en: "Re-assessment Progress"
    card_type: progress
    priority: 85

    # When to show
    display_conditions:
      phase: re_assessment
      completeness: "< 0.60"  # Lower threshold for re-assessment

    # Card content
    content:
      title: "×”×ª×§×“××•×ª ×”×”×¢×¨×›×” ×”××—×•×“×©×ª ğŸ”„"
      body: |
        **×”×©×œ×× ×• {completeness_percentage}% ××”×”×¢×¨×›×”**

        {comparison_to_baseline}

        **×¢×•×“ ×›××” ×“×‘×¨×™× ×œ×‘×“×•×§:**
        {missing_areas}

      comparison_to_baseline:
        source: baseline_parent_report
        format: |
          **×‘×”×©×•×•××” ×œ×‘×¡×™×¡ ({baseline_date}):**
          {initial_concerns} â† ××” ×©×“××’ ××–
          {current_state} â† ××™×¤×” ×× ×—× ×• ×¢×›×©×™×•

      footer: "×××•×§×“×™× ×¢×œ ××” ×©×—×©×•×‘ ğŸ’™"

    # Available actions
    available_actions:
      - continue_interview
      - upload_video
      - view_journal
      - consultation

    # Behavior
    dismissible: false
    updates_dynamically: true

  updated_report_ready_card:
    name: "×“×•×— ××¢×•×“×›×Ÿ ××•×›×Ÿ"
    name_en: "Updated Report Ready"
    card_type: success
    priority: 95

    # When to show
    display_conditions:
      phase: re_assessment
      updated_reports_status: ready
      user_viewed_updated_report: false

    # Card content
    content:
      title: "×”×“×•×— ×”××¢×•×“×›×Ÿ ××•×›×Ÿ! ğŸ“Šâœ¨"
      body: |
        **×”×”×¢×¨×›×” ×”××—×•×“×©×ª ×”×•×©×œ××”!**

        ×”×“×•×— ×”×—×“×© ×›×•×œ×œ:
        â€¢ ×ª××•× ×” ××¢×•×“×›× ×ª ×©×œ {child_name}
        â€¢ ×”×©×•×•××” ×œ×”×¢×¨×›×” ×”×§×•×“××ª
        â€¢ ×”×ª×§×“××•×ª ×•×©×™× ×•×™×™×
        â€¢ ×”××œ×¦×•×ª ××¢×•×“×›× ×•×ª

        {progress_highlight}

      progress_highlight:
        source: updated_parent_report
        extract: comparison_to_baseline.progress_made
        format: "ğŸŒŸ {progress_item}"
        max_items: 2

      footer: "×—×•×–×¨×™× ×œ×œ×™×•×•×™ ×”×©×•×˜×£ ××¢×›×©×™×• ğŸ’™"

    # Available actions
    available_actions:
      - view_report
      - download_report
      - compare_reports  # Side-by-side
      - consultation

    # Behavior
    dismissible: false
    celebration_animation: true
    auto_dismiss_after_action: view_report
    on_dismiss:
      transition_to_phase: ongoing

# Card generation logic
card_generation:
  evaluation_order:
    - "Check phase"
    - "Check artifact statuses"
    - "Check user state (viewed_report, journal_count, etc.)"
    - "Evaluate display_conditions"
    - "Sort by priority"
    - "Take top N cards based on max_cards_visible"

  dynamic_content:
    variable_resolution:
      source_priority:
        - extracted_data  # From interview
        - artifacts  # From generated reports
        - session_state  # Current phase, completeness
        - user_preferences  # Language, tone

      available_variables:
        - "{parent_name}"
        - "{child_name}"
        - "{child_age}"
        - "{completeness_percentage}"
        - "{uploaded_count}"
        - "{journal_entry_count}"
        - "{days_since_baseline}"
        - "{phase}"
        - And more from context

  template_engine:
    syntax: jinja2_compatible
    filters:
      - format_date
      - format_percentage
      - truncate
      - pluralize_he  # Hebrew pluralization
    functions:
      - calculate_time_since
      - extract_from_artifact
      - count_by_status

# Metadata
metadata:
  designed_for: "child_development_workflow"
  language: "he"
  last_updated: "2025-11-08"
  notes: |
    Context cards are the UI reflection of invisible state:

    1. They GUIDE users through the workflow
       - Show what's next
       - Explain current state
       - Offer clear actions

    2. They ADAPT to phase and progress
       - Screening phase: progress-focused
       - Ongoing phase: support-focused
       - Re-assessment: comparison-focused

    3. They CONNECT to system state
       - Artifacts (reports ready?)
       - Phase (where are we?)
       - Actions (what can user do?)
       - Completeness (how far along?)

    4. They COMMUNICATE with warmth
       - Hebrew, empathetic tone
       - Strength-based language
       - Clear next steps
       - No pressure

    Key principles:
    - Cards appear/disappear based on conditions
    - Priority determines order when multiple shown
    - Dynamic content from session state
    - Actions directly connected to user intent
    - Phase-aware everything
